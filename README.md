## üß† Game Hint Bot ‚Äî FastAPI + LangChain + OpenAI

–ò–ò-–∞–≥–µ–Ω—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ **–∏–≥—Ä–æ–≤—ã—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫** –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö —É—Ä–æ–≤–Ω—è.  
–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ FastAPI, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç LangChain –∏ OpenAI GPT-3.5.

---

### üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (—á–µ—Ä–µ–∑ Docker)

#### 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/Baullin1767/game-hint-bot.git
cd game-hint-bot
```

#### 2. –£–∫–∞–∂–∏ API-–∫–ª—é—á OpenAI

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
OPENAI_API_KEY=sk-...  # –í–∞—à Project API Key –æ—Ç OpenAI
```

> ‚ö†Ô∏è –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π User API Keys. –ù—É–∂–µ–Ω Project API Key. –ü–æ–¥—Ä–æ–±–Ω–µ–µ: https://platform.openai.com/api-keys

#### 3. –ó–∞–ø—É—Å—Ç–∏ —á–µ—Ä–µ–∑ Docker

```bash
docker-compose up --build
```

#### 4. –ü–µ—Ä–µ–π–¥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ —Å—Å—ã–ª–∫–µ:

üîó **[http://localhost:8000](http://localhost:8000)** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥—Å–∫–∞–∑–æ–∫

---

### üñ•Ô∏è –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–î–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000/`

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- –í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–¥—Å–∫–∞–∑–æ–∫ –ø–æ JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä–µ
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
- –°–∫–∞—á–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤ –≤–∏–¥–µ JSON-—Ñ–∞–π–ª–∞ (`/hint/download`)
- –£–¥–æ–±–Ω—ã–π –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

---

### üß™ API-–¥–æ—Å—Ç—É–ø

#### `GET /hint?level_id=1`
üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É —É—Ä–æ–≤–Ω—é.  
üì• **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `level_id` (int): –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Ä–æ–≤–Ω—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1`).

üì§ **–û—Ç–≤–µ—Ç:**
```json
{
  "level_id": 1,
  "hints": [
    "–í–æ–∑—å–º–∏ –∫–ª—é—á –Ω–∞ (10, 20), —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –¥–≤–µ—Ä—å –Ω–∞ (80, 80)",
    "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ, –ª–æ–≤—É—à–∫–∞ –Ω–∞ (15, 18)",
    "–ò—Å–ø–æ–ª—å–∑—É–π —Ç–µ–ª–µ–ø–æ—Ä—Ç –Ω–∞ (90, 10)"
  ]
}
```

üß† –ü–æ–¥—Å–∫–∞–∑–∫–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ `cache/hint_level_{id}.json`.

---

#### `GET /hint/download?level_id=1`
üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–∫–∞—á–∏–≤–∞–µ—Ç JSON-—Ñ–∞–π–ª —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è.

üì• **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `level_id` (int): –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Ä–æ–≤–Ω—è.

üì§ **–û—Ç–≤–µ—Ç:**  
–°–∫–∞—á–∏–≤–∞–µ–º—ã–π —Ñ–∞–π–ª `hint_level_{id}.json` —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏.

---

#### `POST /upload`
üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç JSON-—Ñ–∞–π–ª —Å –Ω–æ–≤—ã–º —É—Ä–æ–≤–Ω–µ–º, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –µ–≥–æ –∏ —Å–æ–∑–¥–∞—ë—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏.  
üìÇ **–§–æ—Ä–º–∞ –∑–∞–ø—Ä–æ—Å–∞:** `multipart/form-data`  
–ü–æ–ª—è:
- `file` ‚Äî JSON-—Ñ–∞–π–ª —É—Ä–æ–≤–Ω—è.

üì§ **–û—Ç–≤–µ—Ç:**  
HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –¥–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è.

---

#### `POST /clear-cache`
üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –∫—ç—à–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫.  
üîÑ **–†–µ–¥–∏—Ä–µ–∫—Ç:** –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ `/`.

üì§ **–û—Ç–≤–µ—Ç:** HTTP 303 Redirect ‚Üí `/`

---

#### `GET /`
üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞.  
üì• **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ):**
- `level_id` (int): —É—Ä–æ–≤–µ–Ω—å, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `1`).

üì§ **–û—Ç–≤–µ—Ç:** HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–≤–Ω–µ–π.

---

–í–æ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ API –º–µ—Ç–æ–¥–∞:

---

#### `POST /api/upload`
üìå **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** 
–ó–∞–≥—Ä—É–∂–∞–µ—Ç JSON —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —É—Ä–æ–≤–Ω—è, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –µ–≥–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏. –û—Ç–ª–∏—á–∏–µ –æ—Ç `POST /upload` ‚Äî —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω **–¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (API)** –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç **—á–∏—Å—Ç—ã–π JSON**, –∞ –Ω–µ —Ñ–æ—Ä–º—É —Å —Ñ–∞–π–ª–æ–º.

---

üì• **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ):**

**Content-Type:** `application/json`

```json
{
  "level": {
    "id": 1,
    "objects": [
      { "type": "key", "id": "key_red", "x": 10, "y": 10 },
      { "type": "door", "id": "door_red", "x": 80, "y": 80, "key_id": "key_red" },
      { "type": "trap", "x": 45, "y": 65 }
    ]
  }
}
```
üì§ **–û—Ç–≤–µ—Ç:**

```json
{
  "level_id": 1,
  "hints": [
    "–í–æ–∑—å–º–∏ –∫–ª—é—á –Ω–∞ (10, 10), —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –¥–≤–µ—Ä—å –Ω–∞ (80, 80)",
    "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ, –ª–æ–≤—É—à–∫–∞ –Ω–∞ (45, 65)"
  ]
}
```

---

#### üîπ –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏

- `400 Bad Request` ‚Äî –µ—Å–ª–∏ JSON –Ω–µ–≤–∞–ª–∏–¥–µ–Ω –∏–ª–∏ –Ω–∞—Ä—É—à–∞–µ—Ç —Å—Ö–µ–º—É `LevelData`.

```json
{
  "error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ JSON: Field 'x' is required..."
}

---

### üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
.
‚îú‚îÄ‚îÄ levels/           # JSON-—Ñ–∞–π–ª—ã —É—Ä–æ–≤–Ω–µ–π
‚îú‚îÄ‚îÄ cache/            # –ê–≤—Ç–æ–∫–µ—à –ø–æ–¥—Å–∫–∞–∑–æ–∫ –ø–æ —É—Ä–æ–≤–Ω—è–º
‚îú‚îÄ‚îÄ templates/        # HTML —à–∞–±–ª–æ–Ω—ã (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
‚îú‚îÄ‚îÄ main.py           # FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ llm_agent.py      # –†–∞–±–æ—Ç–∞ —Å LangChain + OpenAI
‚îú‚îÄ‚îÄ prompt.py         # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
‚îú‚îÄ‚îÄ schemas.py        # –í–∞–ª–∏–¥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ utils.py          # –ü–∞—Ä—Å–∏–Ω–≥
‚îú‚îÄ‚îÄ Dockerfile        # –°–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ .env              # –í–∞—à API-–∫–ª—é—á OpenAI (–ª–æ–∫–∞–ª—å–Ω–æ)
```

---

### üìÑ –ü—Ä–∏–º–µ—Ä JSON —É—Ä–æ–≤–Ω—è

```json
{
  "level": {
    "id": 1,
    "objects": [
      { "type": "player", "x": 5, "y": 5 },
      { "type": "key", "id": "key_red", "x": 10, "y": 20 },
      { "type": "door", "id": "door_red", "key_id": "key_red", "x": 80, "y": 80 }
    ]
  }
}
```

---

### üìå –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –Ω—é–∞–Ω—Å—ã

- üîê –ù–µ –∑–∞–±—É–¥—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Project API Key** –æ—Ç OpenAI (–∏–Ω–∞—á–µ –±—É–¥–µ—Ç `401 not_authorized_invalid_key_type`)
- üí° –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –æ–±—ä–µ–∫—Ç–æ–≤ (–∫–ª—é—á–∏, –¥–≤–µ—Ä–∏, –ª–æ–≤—É—à–∫–∏, —Å—É–Ω–¥—É–∫–∏, –±–æ–Ω—É—Å—ã, –∫–Ω–æ–ø–∫–∏, —Ç–µ–ª–µ–ø–æ—Ä—Ç—ã –∏ —Ç.–¥.)
- ‚úÖ JSON –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ LLM
- üöÄ –ü—Ä–æ–º–ø—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤

---
